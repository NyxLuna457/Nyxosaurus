<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Projet-Application-Python/Mise-en-place-CICD" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Mise en place d&#x27;une logique CI/CD | NyxoWiki</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://nyxluna457.github.io/Nyxosaurus/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://nyxluna457.github.io/Nyxosaurus/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://nyxluna457.github.io/Nyxosaurus/docs/Projet-Application-Python/Mise-en-place-CICD"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Mise en place d&#x27;une logique CI/CD | NyxoWiki"><meta data-rh="true" name="description" content="Ce guide explique comment mettre en place un déploiement continu (CI/CD) pour une application Python sur une VM Ubuntu, en utilisant Tailscale pour un accès réseau privé, PM2 comme gestionnaire de processus Python, et un workflow GitHub Actions (fichier .yml) pour automatiser le déploiement à chaque git push."><meta data-rh="true" property="og:description" content="Ce guide explique comment mettre en place un déploiement continu (CI/CD) pour une application Python sur une VM Ubuntu, en utilisant Tailscale pour un accès réseau privé, PM2 comme gestionnaire de processus Python, et un workflow GitHub Actions (fichier .yml) pour automatiser le déploiement à chaque git push."><link data-rh="true" rel="icon" href="/Nyxosaurus/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://nyxluna457.github.io/Nyxosaurus/docs/Projet-Application-Python/Mise-en-place-CICD"><link data-rh="true" rel="alternate" href="https://nyxluna457.github.io/Nyxosaurus/docs/Projet-Application-Python/Mise-en-place-CICD" hreflang="en"><link data-rh="true" rel="alternate" href="https://nyxluna457.github.io/Nyxosaurus/docs/Projet-Application-Python/Mise-en-place-CICD" hreflang="x-default"><link rel="stylesheet" href="/Nyxosaurus/assets/css/styles.2ce171b8.css">
<script src="/Nyxosaurus/assets/js/runtime~main.8e47fc30.js" defer="defer"></script>
<script src="/Nyxosaurus/assets/js/main.7551f14a.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/Nyxosaurus/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Nyxosaurus/"><div class="navbar__logo"><img src="/Nyxosaurus/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/Nyxosaurus/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">My Site</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/Nyxosaurus/docs/category/projet-application-python">Tutorial</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/Nyxosaurus/docs/category/projet-application-python">Projet Application Python</a><button aria-label="Collapse sidebar category &#x27;Projet Application Python&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Nyxosaurus/docs/Projet-Application-Python/Créer-une-application-Python">Créer une application Python</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Nyxosaurus/docs/Projet-Application-Python/Connecter-une-BD-à-une-application-Python">Connecter une BD à une application Python</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Nyxosaurus/docs/Projet-Application-Python/Integrer-une-DB-a-une-page-web">Afficher le contenu de la BD sur la page Web</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Nyxosaurus/docs/Projet-Application-Python/Dns-ou-Reverse-Proxy">DNS ou Reverse Proxy ?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Nyxosaurus/docs/Projet-Application-Python/Monitoring">Monitoring via Grafana/Prometheus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/Nyxosaurus/docs/Projet-Application-Python/Mise-en-place-CICD">Mise en place d&#x27;une logique CI/CD</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/Nyxosaurus/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/Nyxosaurus/docs/category/projet-application-python"><span itemprop="name">Projet Application Python</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Mise en place d&#x27;une logique CI/CD</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Mise en place d&#x27;une logique CI/CD</h1></header>
<h1>Déploiement automatisé via Tailscale, GitHub Actions et PM2</h1>
<p>Ce guide explique comment mettre en place un déploiement continu (CI/CD) pour une <strong>application Python</strong> sur une VM Ubuntu, en utilisant <strong>Tailscale</strong> pour un accès réseau privé, <strong>PM2</strong> comme gestionnaire de processus Python, et un workflow GitHub Actions (fichier <code>.yml</code>) pour automatiser le déploiement à chaque <code>git push</code>.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="sommaire">Sommaire<a href="#sommaire" class="hash-link" aria-label="Direct link to Sommaire" title="Direct link to Sommaire">​</a></h2>
<ol>
<li>Pré-requis</li>
<li>Installation et configuration de Tailscale</li>
<li>Installation et configuration de PM2 pour Python</li>
<li>Préparation de la VM Ubuntu pour le déploiement Python</li>
<li>Configuration du workflow GitHub Actions (<code>.github/workflows/deploy.yml</code>)</li>
<li>Sécurisation et tests</li>
<li>Résumé du flux</li>
</ol>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-pré-requis">1. Pré-requis<a href="#1-pré-requis" class="hash-link" aria-label="Direct link to 1. Pré-requis" title="Direct link to 1. Pré-requis">​</a></h2>
<ul>
<li>Un dépôt GitHub pour ton application Python.</li>
<li>Une VM Ubuntu Server (hébergeant l’application Python et MariaDB).</li>
<li>Un compte Tailscale et Tailscale installé sur la VM Ubuntu.</li>
<li>Un Tailscale Auth Key (clé d’authentification pour CI/CD).</li>
<li>Un accès SSH à la VM Ubuntu (via Tailscale).</li>
<li>Un fichier <code>.yml</code> pour GitHub Actions.</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-installation-et-configuration-de-tailscale">2. Installation et configuration de Tailscale<a href="#2-installation-et-configuration-de-tailscale" class="hash-link" aria-label="Direct link to 2. Installation et configuration de Tailscale" title="Direct link to 2. Installation et configuration de Tailscale">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="a-installer-tailscale-sur-la-vm-ubuntu">a. Installer Tailscale sur la VM Ubuntu<a href="#a-installer-tailscale-sur-la-vm-ubuntu" class="hash-link" aria-label="Direct link to a. Installer Tailscale sur la VM Ubuntu" title="Direct link to a. Installer Tailscale sur la VM Ubuntu">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -fsSL https://tailscale.com/install.sh | sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo tailscale up --authkey=&lt;TAILSCALE_AUTHKEY&gt; --hostname=&quot;ubuntu-app-server&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>Génère un Auth Key sur le dashboard Tailscale (section Keys), choisis une clé <strong>ephemeral</strong> et <strong>reusable</strong> pour CI/CD.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="b-vérifier-ladresse-tailscale-de-la-vm">b. Vérifier l’adresse Tailscale de la VM<a href="#b-vérifier-ladresse-tailscale-de-la-vm" class="hash-link" aria-label="Direct link to b. Vérifier l’adresse Tailscale de la VM" title="Direct link to b. Vérifier l’adresse Tailscale de la VM">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tailscale ip -4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>Note cette IP (ex: <code>100.x.x.x</code>).</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-installation-et-configuration-de-pm2-pour-python">3. Installation et configuration de PM2 pour Python<a href="#3-installation-et-configuration-de-pm2-pour-python" class="hash-link" aria-label="Direct link to 3. Installation et configuration de PM2 pour Python" title="Direct link to 3. Installation et configuration de PM2 pour Python">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="a-installer-nodejs-et-pm2">a. Installer Node.js et PM2<a href="#a-installer-nodejs-et-pm2" class="hash-link" aria-label="Direct link to a. Installer Node.js et PM2" title="Direct link to a. Installer Node.js et PM2">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt install -y nodejs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo npm install -g pm2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="b-lancer-lapplication-python-avec-pm2">b. Lancer l’application Python avec PM2<a href="#b-lancer-lapplication-python-avec-pm2" class="hash-link" aria-label="Direct link to b. Lancer l’application Python avec PM2" title="Direct link to b. Lancer l’application Python avec PM2">​</a></h3>
<p>Depuis le dossier de ton projet (par exemple <code>/opt/ton-repo</code>) :</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pm2 start app.py --interpreter /usr/bin/python3 --name myapp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li><code>--interpreter /usr/bin/python3</code> force l’utilisation de Python 3.</li>
<li><code>--name myapp</code> donne un nom à ton processus.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="c-sassurer-que-lapplication-redémarre-au-reboot">c. S’assurer que l’application redémarre au reboot<a href="#c-sassurer-que-lapplication-redémarre-au-reboot" class="hash-link" aria-label="Direct link to c. S’assurer que l’application redémarre au reboot" title="Direct link to c. S’assurer que l’application redémarre au reboot">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pm2 startup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Suis l’instruction affichée (copie/colle la commande générée)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pm2 save</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>Cela garantit que PM2 relancera ton appli Python automatiquement après un redémarrage du serveur[^5].</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="d-commandes-utiles-pm2">d. Commandes utiles PM2<a href="#d-commandes-utiles-pm2" class="hash-link" aria-label="Direct link to d. Commandes utiles PM2" title="Direct link to d. Commandes utiles PM2">​</a></h3>
<ul>
<li>Redémarrer l’appli : <code>pm2 restart myapp</code></li>
<li>Voir les logs : <code>pm2 logs myapp</code></li>
<li>Lister les apps : <code>pm2 list</code></li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-préparation-de-la-vm-ubuntu-pour-le-déploiement-python">4. Préparation de la VM Ubuntu pour le déploiement Python<a href="#4-préparation-de-la-vm-ubuntu-pour-le-déploiement-python" class="hash-link" aria-label="Direct link to 4. Préparation de la VM Ubuntu pour le déploiement Python" title="Direct link to 4. Préparation de la VM Ubuntu pour le déploiement Python">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="a-cloner-le-dépôt-sur-la-vm">a. Cloner le dépôt sur la VM<a href="#a-cloner-le-dépôt-sur-la-vm" class="hash-link" aria-label="Direct link to a. Cloner le dépôt sur la VM" title="Direct link to a. Cloner le dépôt sur la VM">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git clone git@github.com:ton-utilisateur/ton-repo.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd ton-repo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>Configure les clés SSH pour permettre le <code>git pull</code> sans mot de passe.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="b-créer-un-script-de-déploiement">b. Créer un script de déploiement<a href="#b-créer-un-script-de-déploiement" class="hash-link" aria-label="Direct link to b. Créer un script de déploiement" title="Direct link to b. Créer un script de déploiement">​</a></h3>
<p>Dans <code>/opt/ton-repo/deploy.sh</code> :</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">\#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git pull origin main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pm2 restart myapp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Rends-le exécutable :</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chmod +x deploy.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-configuration-du-workflow-github-actions-githubworkflowsdeployyml">5. Configuration du workflow GitHub Actions (<code>.github/workflows/deploy.yml</code>)<a href="#5-configuration-du-workflow-github-actions-githubworkflowsdeployyml" class="hash-link" aria-label="Direct link to 5-configuration-du-workflow-github-actions-githubworkflowsdeployyml" title="Direct link to 5-configuration-du-workflow-github-actions-githubworkflowsdeployyml">​</a></h2>
<p>Crée un fichier <code>.github/workflows/deploy.yml</code> dans ton dépôt GitHub :</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name: Deploy to Ubuntu App Server via Tailscale and PM2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">on:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">push:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">branches:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jobs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deploy:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">runs-on: ubuntu-latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Checkout code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uses: actions/checkout@v4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Set up Tailscale</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uses: tailscale/github-action@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          authkey: ${{ secrets.TAILSCALE_AUTHKEY }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Wait for Tailscale</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        run: sleep 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Deploy via SSH</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        env:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          SSH_PRIVATE_KEY: ${{ secrets.SSH_PRIVATE_KEY }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        run: |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          echo &quot;$SSH_PRIVATE_KEY&quot; &gt; id_rsa</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          chmod 600 id_rsa</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          ssh -o StrictHostKeyChecking=no -i id_rsa ubuntu@&lt;IP_TAILSCALE_VM&gt; &#x27;cd /opt/ton-repo &amp;&amp; ./deploy.sh&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>Remplace <code>&lt;IP_TAILSCALE_VM&gt;</code> par l’IP Tailscale de ta VM Ubuntu (ex : <code>100.x.x.x</code>).</li>
<li><code>TAILSCALE_AUTHKEY</code> et <code>SSH_PRIVATE_KEY</code> sont à stocker dans les secrets GitHub.</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="6-sécurisation-et-tests">6. Sécurisation et tests<a href="#6-sécurisation-et-tests" class="hash-link" aria-label="Direct link to 6. Sécurisation et tests" title="Direct link to 6. Sécurisation et tests">​</a></h2>
<ul>
<li><strong>Secrets GitHub</strong> : Ajoute <code>TAILSCALE_AUTHKEY</code> et <code>SSH_PRIVATE_KEY</code> dans les paramètres du dépôt GitHub (Settings &gt; Secrets and variables &gt; Actions).</li>
<li><strong>Test du workflow</strong> : Fais une modification et un <code>git push</code> sur <code>main</code>. Vérifie sur GitHub Actions que le workflow s’exécute sans erreur et que l’application Python est redéployée sur la VM.</li>
<li><strong>Logs</strong> : Consulte les logs du workflow GitHub et ceux de <code>pm2 logs myapp</code> sur la VM pour diagnostiquer d’éventuels problèmes.</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="7-résumé-du-flux">7. Résumé du flux<a href="#7-résumé-du-flux" class="hash-link" aria-label="Direct link to 7. Résumé du flux" title="Direct link to 7. Résumé du flux">​</a></h2>
<ol>
<li>Tu fais un <code>git push</code> sur la branche <code>main</code> de ton dépôt GitHub.</li>
<li>GitHub Actions lance le workflow défini dans <code>.github/workflows/deploy.yml</code>.</li>
<li>Le workflow établit une connexion Tailscale, puis se connecte en SSH à ta VM Ubuntu via son IP Tailscale.</li>
<li>Il exécute le script de déploiement (<code>deploy.sh</code>) sur la VM, qui fait un <code>git pull</code> et redémarre l’application Python via PM2.</li>
<li>Les changements sont appliqués automatiquement, de manière sécurisée et privée grâce à Tailscale.</li>
</ol>
<hr>
<p>Avec cette méthode, tu bénéficies d’un déploiement continu sécurisé, sans exposition de ports publics, et d’une gestion simplifiée de ton application Python grâce à PM2.</p>
<pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"></code></pre></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Projet-Application-Python/Mise-en-place-CICD.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/Nyxosaurus/docs/Projet-Application-Python/Monitoring"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Monitoring via Grafana/Prometheus</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#sommaire" class="table-of-contents__link toc-highlight">Sommaire</a></li><li><a href="#1-pré-requis" class="table-of-contents__link toc-highlight">1. Pré-requis</a></li><li><a href="#2-installation-et-configuration-de-tailscale" class="table-of-contents__link toc-highlight">2. Installation et configuration de Tailscale</a><ul><li><a href="#a-installer-tailscale-sur-la-vm-ubuntu" class="table-of-contents__link toc-highlight">a. Installer Tailscale sur la VM Ubuntu</a></li><li><a href="#b-vérifier-ladresse-tailscale-de-la-vm" class="table-of-contents__link toc-highlight">b. Vérifier l’adresse Tailscale de la VM</a></li></ul></li><li><a href="#3-installation-et-configuration-de-pm2-pour-python" class="table-of-contents__link toc-highlight">3. Installation et configuration de PM2 pour Python</a><ul><li><a href="#a-installer-nodejs-et-pm2" class="table-of-contents__link toc-highlight">a. Installer Node.js et PM2</a></li><li><a href="#b-lancer-lapplication-python-avec-pm2" class="table-of-contents__link toc-highlight">b. Lancer l’application Python avec PM2</a></li><li><a href="#c-sassurer-que-lapplication-redémarre-au-reboot" class="table-of-contents__link toc-highlight">c. S’assurer que l’application redémarre au reboot</a></li><li><a href="#d-commandes-utiles-pm2" class="table-of-contents__link toc-highlight">d. Commandes utiles PM2</a></li></ul></li><li><a href="#4-préparation-de-la-vm-ubuntu-pour-le-déploiement-python" class="table-of-contents__link toc-highlight">4. Préparation de la VM Ubuntu pour le déploiement Python</a><ul><li><a href="#a-cloner-le-dépôt-sur-la-vm" class="table-of-contents__link toc-highlight">a. Cloner le dépôt sur la VM</a></li><li><a href="#b-créer-un-script-de-déploiement" class="table-of-contents__link toc-highlight">b. Créer un script de déploiement</a></li></ul></li><li><a href="#5-configuration-du-workflow-github-actions-githubworkflowsdeployyml" class="table-of-contents__link toc-highlight">5. Configuration du workflow GitHub Actions (<code>.github/workflows/deploy.yml</code>)</a></li><li><a href="#6-sécurisation-et-tests" class="table-of-contents__link toc-highlight">6. Sécurisation et tests</a></li><li><a href="#7-résumé-du-flux" class="table-of-contents__link toc-highlight">7. Résumé du flux</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/Nyxosaurus/docs/Projet-Application-Python/Créer-une-application-Python">Projet Application Python</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>