"use strict";(self.webpackChunkmy_tutorial_wiki=self.webpackChunkmy_tutorial_wiki||[]).push([[45],{8453:(e,n,r)=>{r.d(n,{R:()=>a,x:()=>t});var l=r(6540);const s={},i=l.createContext(s);function a(e){const n=l.useContext(i);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),l.createElement(i.Provider,{value:n},e.children)}},9993:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>t,default:()=>u,frontMatter:()=>a,metadata:()=>l,toc:()=>o});const l=JSON.parse('{"id":"Projet-Application-Python/Integrer-une-DB-a-une-page-web","title":"Afficher le contenu de la BD sur la page Web","description":"Ce guide d\xe9taille chaque \xe9tape pour :","source":"@site/docs/Projet-Application-Python/Integrer-une-DB-a-une-page-web.md","sourceDirName":"Projet-Application-Python","slug":"/Projet-Application-Python/Integrer-une-DB-a-une-page-web","permalink":"/Nyxosaurus/docs/Projet-Application-Python/Integrer-une-DB-a-une-page-web","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Projet-Application-Python/Integrer-une-DB-a-une-page-web.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Connecter une BD \xe0 une application Python","permalink":"/Nyxosaurus/docs/Projet-Application-Python/Connecter-une-BD-\xe0-une-application-Python"},"next":{"title":"DNS ou Reverse Proxy ?","permalink":"/Nyxosaurus/docs/Projet-Application-Python/Dns-ou-Reverse-Proxy"}}');var s=r(4848),i=r(8453);const a={},t="Afficher le contenu de la BD sur la page Web",d={},o=[{value:"1. Cr\xe9ation d&#39;une base de donn\xe9es et d&#39;un utilisateur MariaDB",id:"1-cr\xe9ation-dune-base-de-donn\xe9es-et-dun-utilisateur-mariadb",level:2},{value:"a. Se connecter \xe0 MariaDB en tant qu&#39;administrateur",id:"a-se-connecter-\xe0-mariadb-en-tant-quadministrateur",level:3},{value:"b. Cr\xe9er une nouvelle base de donn\xe9es",id:"b-cr\xe9er-une-nouvelle-base-de-donn\xe9es",level:3},{value:"c. Cr\xe9er un utilisateur d\xe9di\xe9 et lui donner les droits",id:"c-cr\xe9er-un-utilisateur-d\xe9di\xe9-et-lui-donner-les-droits",level:3},{value:"d. V\xe9rifier la cr\xe9ation",id:"d-v\xe9rifier-la-cr\xe9ation",level:3},{value:"2. Cr\xe9ation d&#39;une table et insertion de donn\xe9es",id:"2-cr\xe9ation-dune-table-et-insertion-de-donn\xe9es",level:2},{value:"a. Se connecter avec le nouvel utilisateur",id:"a-se-connecter-avec-le-nouvel-utilisateur",level:3},{value:"b. Cr\xe9er une table",id:"b-cr\xe9er-une-table",level:3},{value:"c. Ins\xe9rer des donn\xe9es dans la table",id:"c-ins\xe9rer-des-donn\xe9es-dans-la-table",level:3},{value:"d. V\xe9rifier le contenu de la table",id:"d-v\xe9rifier-le-contenu-de-la-table",level:3},{value:"3. Pr\xe9parer le projet Flask",id:"3-pr\xe9parer-le-projet-flask",level:2},{value:"a. Installer les d\xe9pendances",id:"a-installer-les-d\xe9pendances",level:3},{value:"4. \xc9crire le code Flask pour afficher la table",id:"4-\xe9crire-le-code-flask-pour-afficher-la-table",level:2},{value:"a. Fichier <code>app.py</code> :",id:"a-fichier-apppy-",level:3},{value:"5. Lancer l\u2019application",id:"5-lancer-lapplication",level:2},{value:"R\xe9sum\xe9",id:"r\xe9sum\xe9",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"afficher-le-contenu-de-la-bd-sur-la-page-web",children:"Afficher le contenu de la BD sur la page Web"})}),"\n",(0,s.jsx)(n.p,{children:"Ce guide d\xe9taille chaque \xe9tape pour :"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#1-cr%C3%A9ation-dune-base-de-donn%C3%A9es-et-dun-utilisateur-mariadb",children:"Cr\xe9er une base de donn\xe9es MariaDB et un utilisateur d\xe9di\xe9"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#2-cr%C3%A9ation-dune-table-et-insertion-de-donn%C3%A9es",children:"Cr\xe9er une table et ins\xe9rer des donn\xe9es"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#3-pr%C3%A9parer-le-projet-flask",children:"Configurer une application Flask pour afficher dynamiquement le contenu de cette table"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#4-%C3%A9crire-le-code-flask-pour-afficher-la-table",children:"\xc9crire le code Flask pour afficher la table"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#5-lancer-lapplication",children:"Lancer l\u2019application"})}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"1-cr\xe9ation-dune-base-de-donn\xe9es-et-dun-utilisateur-mariadb",children:"1. Cr\xe9ation d'une base de donn\xe9es et d'un utilisateur MariaDB"}),"\n",(0,s.jsx)(n.h3,{id:"a-se-connecter-\xe0-mariadb-en-tant-quadministrateur",children:"a. Se connecter \xe0 MariaDB en tant qu'administrateur"}),"\n",(0,s.jsx)(n.p,{children:"Sur ta VM, ouvre un terminal et lance :"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\nsudo mariadb\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"b-cr\xe9er-une-nouvelle-base-de-donn\xe9es",children:"b. Cr\xe9er une nouvelle base de donn\xe9es"}),"\n",(0,s.jsx)(n.p,{children:"Dans le shell MariaDB, ex\xe9cute :"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\nCREATE DATABASE demo CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;\n\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Ici, ",(0,s.jsx)(n.code,{children:"demo"})," est le nom de ta base. Tu peux le personnaliser."]}),"\n",(0,s.jsxs)(n.li,{children:["Le jeu de caract\xe8res ",(0,s.jsx)(n.code,{children:"utf8mb4"})," permet de stocker tous types de caract\xe8res (y compris les emojis)."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"c-cr\xe9er-un-utilisateur-d\xe9di\xe9-et-lui-donner-les-droits",children:"c. Cr\xe9er un utilisateur d\xe9di\xe9 et lui donner les droits"}),"\n",(0,s.jsx)(n.p,{children:"Toujours dans le shell MariaDB, ex\xe9cute :"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\nCREATE USER 'flaskuser'@'localhost' IDENTIFIED BY 'motdepassefort';\nGRANT ALL PRIVILEGES ON demo.* TO 'flaskuser'@'localhost';\nFLUSH PRIVILEGES;\n\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Remplace ",(0,s.jsx)(n.code,{children:"flaskuser"})," et ",(0,s.jsx)(n.code,{children:"motdepassefort"})," par des valeurs s\xe9curis\xe9es."]}),"\n",(0,s.jsxs)(n.li,{children:["L'utilisateur n\u2019aura des droits que sur la base ",(0,s.jsx)(n.code,{children:"demo"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"d-v\xe9rifier-la-cr\xe9ation",children:"d. V\xe9rifier la cr\xe9ation"}),"\n",(0,s.jsx)(n.p,{children:"Pour voir la liste des bases :"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\nSHOW DATABASES;\n\n"})}),"\n",(0,s.jsx)(n.p,{children:"Pour voir les utilisateurs :"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\nSELECT User, Host FROM mysql.user;\n\n"})}),"\n",(0,s.jsx)(n.p,{children:"Quitte le shell MariaDB :"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\nEXIT;\n\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"2-cr\xe9ation-dune-table-et-insertion-de-donn\xe9es",children:"2. Cr\xe9ation d'une table et insertion de donn\xe9es"}),"\n",(0,s.jsx)(n.h3,{id:"a-se-connecter-avec-le-nouvel-utilisateur",children:"a. Se connecter avec le nouvel utilisateur"}),"\n",(0,s.jsx)(n.p,{children:"Dans le terminal :"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\nmariadb -u flaskuser -p demo\n\n"})}),"\n",(0,s.jsx)(n.p,{children:"Entre le mot de passe d\xe9fini plus haut."}),"\n",(0,s.jsx)(n.h3,{id:"b-cr\xe9er-une-table",children:"b. Cr\xe9er une table"}),"\n",(0,s.jsxs)(n.p,{children:["Par exemple, une table ",(0,s.jsx)(n.code,{children:"Personel"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\nCREATE TABLE Personel (\nid INT PRIMARY KEY AUTO_INCREMENT,\nPr\xe9noms VARCHAR(50) NOT NULL,\nNom VARCHAR(50) NOT NULL\n);\n\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"id"})," est une cl\xe9 primaire auto-incr\xe9ment\xe9e."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Pr\xe9noms"})," et ",(0,s.jsx)(n.code,{children:"Nom"})," sont des champs texte."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"c-ins\xe9rer-des-donn\xe9es-dans-la-table",children:"c. Ins\xe9rer des donn\xe9es dans la table"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\nINSERT INTO Personel (Pr\xe9noms, Nom) VALUES\n('Alice', 'Martin'),\n('Bob', 'Durand'),\n('Claire', 'Lefevre');\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"d-v\xe9rifier-le-contenu-de-la-table",children:"d. V\xe9rifier le contenu de la table"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\nSELECT * FROM Personel;\n\n"})}),"\n",(0,s.jsx)(n.p,{children:"Quitte le shell MariaDB :"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\nEXIT;\n\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"3-pr\xe9parer-le-projet-flask",children:"3. Pr\xe9parer le projet Flask"}),"\n",(0,s.jsx)(n.h3,{id:"a-installer-les-d\xe9pendances",children:"a. Installer les d\xe9pendances"}),"\n",(0,s.jsx)(n.p,{children:"Dans ton dossier de projet Python :"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo apt install libmariadb-dev\npip install flask python-dotenv mariadb\n\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"4-\xe9crire-le-code-flask-pour-afficher-la-table",children:"4. \xc9crire le code Flask pour afficher la table"}),"\n",(0,s.jsxs)(n.h3,{id:"a-fichier-apppy-",children:["a. Fichier ",(0,s.jsx)(n.code,{children:"app.py"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-Python",children:"import os\nfrom flask import Flask, render_template\nfrom dotenv import load_dotenv\nimport mariadb\n\n# Charger les variables d'environnement du fichier .env\nload_dotenv()\n\napp = Flask(__name__)\n\ndef get_db_connection():\n    return mariadb.connect(\n        host=os.getenv('DB_HOST'),\n        user=os.getenv('DB_USER'),\n        password=os.getenv('DB_PASSWORD'),\n        database=os.getenv('DB_NAME')\n    )\ndb_config = {\n    'host': os.getenv('DB_HOST'),\n    'user': os.getenv('DB_USER'),\n    'password': os.getenv('DB_PASSWORD'),\n    'database': os.getenv('DB_NAME')\n}\n\n@app.route('/')\ndef afficher_personnes():\n    try:\n        conn = mariadb.connect(**db_config)\n        cur = conn.cursor()\n        cur.execute(\"SELECT id, Pr\xe9noms, Nom FROM Personel;\")\n        personnes = cur.fetchall()\n        conn.close()\n    except mariadb.Error as e:\n        return f\"<h1>Erreur de connexion \xe0 la base de donn\xe9es :</h1><pre>{e}</pre>\"\n\n    # Template HTML simple\n    html = '''\n    <h1>Liste du Personel</h1>\n    <table border=\"1\">\n        <tr>\n            <th>ID</th><th>Nom</th><th>Pr\xe9nom</th>\n        </tr>\n        {% for p in personnes %}\n        <tr>\n            <td>{{ p[0] }}</td>\n            <td>{{ p[1] }}</td>\n            <td>{{ p[2] }}</td>\n        </tr>\n        {% endfor %}\n    </table>\n    '''\n    return render_template_string(html, personnes=personnes)\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=5000, debug=True)\n\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"5-lancer-lapplication",children:"5. Lancer l\u2019application"}),"\n",(0,s.jsx)(n.p,{children:"Dans le terminal :"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\npython app.py\n\n"})}),"\n",(0,s.jsx)(n.p,{children:"Puis ouvre ton navigateur \xe0 l\u2019adresse :"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\nhttp://<ip_de_ta_vm>:5000/personnes\n\n"})}),"\n",(0,s.jsx)(n.p,{children:"ou, si tu utilises un reverse proxy/nginx et un DNS local :"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\nhttp://monapp.local\n\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"r\xe9sum\xe9",children:"R\xe9sum\xe9"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Cr\xe9ation d\u2019une base et d\u2019un utilisateur MariaDB d\xe9di\xe9s"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Cr\xe9ation d\u2019une table et insertion de donn\xe9es"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsxs)(n.strong,{children:["Connexion \xe0 la base depuis Flask avec des identifiants s\xe9curis\xe9s dans ",(0,s.jsx)(n.code,{children:".env"})]})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Affichage dynamique du contenu de la table sur la page web Flask"})}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Tu peux adapter ce mod\xe8le pour n\u2019importe quelle table ou structure de donn\xe9es\u202f!"})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}}}]);