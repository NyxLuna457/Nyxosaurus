"use strict";(self.webpackChunkmy_tutorial_wiki=self.webpackChunkmy_tutorial_wiki||[]).push([[210],{7131:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>t,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"Projet-Application-Python/Monitoring","title":"Monitoring via Grafana/Prometheus","description":"Ce guide d\xe9taille comment monitorer\u202f:","source":"@site/docs/Projet-Application-Python/Monitoring.md","sourceDirName":"Projet-Application-Python","slug":"/Projet-Application-Python/Monitoring","permalink":"/Nyxosaurus/docs/Projet-Application-Python/Monitoring","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Projet-Application-Python/Monitoring.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"DNS ou Reverse Proxy ?","permalink":"/Nyxosaurus/docs/Projet-Application-Python/Dns-ou-Reverse-Proxy"},"next":{"title":"Mise en place d\'une logique CI/CD","permalink":"/Nyxosaurus/docs/Projet-Application-Python/Mise-en-place-CICD"}}');var a=r(4848),l=r(8453);const i={},t="Monitoring via Grafana/Prometheus",o={},d=[{value:"Sommaire",id:"sommaire",level:2},{value:"1. Sch\xe9ma de l\u2019architecture",id:"1-sch\xe9ma-de-larchitecture",level:2},{value:"2. Sur la VM Ubuntu (App + MariaDB)",id:"2-sur-la-vm-ubuntu-app--mariadb",level:2},{value:"a. Installer Node Exporter (monitoring syst\xe8me)",id:"a-installer-node-exporter-monitoring-syst\xe8me",level:3},{value:"b. Installer mysqld_exporter (monitoring MariaDB)",id:"b-installer-mysqld_exporter-monitoring-mariadb",level:3},{value:"c. Exposer les m\xe9triques de l\u2019application Python",id:"c-exposer-les-m\xe9triques-de-lapplication-python",level:3},{value:"3. Sur la VM Debian (Monitoring)",id:"3-sur-la-vm-debian-monitoring",level:2},{value:"a. Installer Prometheus",id:"a-installer-prometheus",level:3},{value:"b. Configurer Prometheus pour scraper la VM Ubuntu",id:"b-configurer-prometheus-pour-scraper-la-vm-ubuntu",level:3},{value:"c. Installer Grafana",id:"c-installer-grafana",level:3},{value:"d. Connecter Grafana \xe0 Prometheus",id:"d-connecter-grafana-\xe0-prometheus",level:3},{value:"4. Cr\xe9er et importer des dashboards Grafana",id:"4-cr\xe9er-et-importer-des-dashboards-grafana",level:2},{value:"a. Dashboard syst\xe8me (Node Exporter)",id:"a-dashboard-syst\xe8me-node-exporter",level:3},{value:"b. Dashboard MariaDB/MySQL",id:"b-dashboard-mariadbmysql",level:3},{value:"c. Dashboard pour l\u2019application Python (exemple d\xe9taill\xe9)",id:"c-dashboard-pour-lapplication-python-exemple-d\xe9taill\xe9",level:3},{value:"Exemple de panels pour ton dashboard Python",id:"exemple-de-panels-pour-ton-dashboard-python",level:4},{value:"Comment cr\xe9er ce dashboard dans Grafana",id:"comment-cr\xe9er-ce-dashboard-dans-grafana",level:4},{value:"5. Ressources",id:"5-ressources",level:2}];function c(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"monitoring-via-grafanaprometheus",children:"Monitoring via Grafana/Prometheus"})}),"\n",(0,a.jsx)(n.p,{children:"Ce guide d\xe9taille comment monitorer\u202f:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Une VM Ubuntu Server h\xe9bergeant \xe0 la fois l\u2019application Python ",(0,a.jsx)(n.strong,{children:"et"})," la base MariaDB"]}),"\n",(0,a.jsxs)(n.li,{children:["Depuis une VM Debian (sans interface graphique, vierge sauf openssh-server) qui h\xe9berge ",(0,a.jsx)(n.strong,{children:"Prometheus"})," et ",(0,a.jsx)(n.strong,{children:"Grafana"})]}),"\n"]}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:(0,a.jsxs)(n.strong,{children:["\xc0 chaque fois que tu vois une adresse IP (exemple\u202f: ",(0,a.jsx)(n.code,{children:"192.168.1.100"})," ou ",(0,a.jsx)(n.code,{children:"192.168.1.90"}),"), ADAPTE-LA \xe0 ton propre r\xe9seau !"]})}),"\n"]}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"sommaire",children:"Sommaire"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#1-sch%C3%A9ma-de-larchitecture",children:"Sch\xe9ma de l\u2019architecture"})}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.a,{href:"#2-sur-la-vm-ubuntu-app--mariadb",children:"Sur la VM Ubuntu (App + MariaDB)"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"a. Installer Node Exporter (monitoring syst\xe8me)"}),"\n",(0,a.jsx)(n.li,{children:"b. Installer mysqld_exporter (monitoring MariaDB)"}),"\n",(0,a.jsx)(n.li,{children:"c. Exposer les m\xe9triques de l\u2019application Python"}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.a,{href:"#3-sur-la-vm-debian-monitoring",children:"Sur la VM Debian (Monitoring)"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"a. Installer Prometheus"}),"\n",(0,a.jsx)(n.li,{children:"b. Configurer Prometheus pour scraper la VM Ubuntu"}),"\n",(0,a.jsx)(n.li,{children:"c. Installer Grafana"}),"\n",(0,a.jsx)(n.li,{children:"d. Connecter Grafana \xe0 Prometheus"}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.a,{href:"#4-cr%C3%A9er-et-importer-des-dashboards-grafana",children:"Cr\xe9er et importer des dashboards Grafana"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"a. Dashboard syst\xe8me"}),"\n",(0,a.jsx)(n.li,{children:"b. Dashboard MariaDB"}),"\n",(0,a.jsx)(n.li,{children:"c. Dashboard pour l\u2019application Python (exemple d\xe9taill\xe9)"}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#5-ressources",children:"Ressources"})}),"\n"]}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"1-sch\xe9ma-de-larchitecture",children:"1. Sch\xe9ma de l\u2019architecture"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"[ VM Ubuntu ]\n\u251c\u2500 Application Python (port 5000)\n\u251c\u2500 MariaDB\n\u251c\u2500 Node Exporter (port 9100)\n\u2514\u2500 mysqld_exporter (port 9104)\n\u2502\n\u25bc\n[ R\xe9seau local ]\n\u2502\n\u25bc\n[ VM Debian ]\n\u251c\u2500 Prometheus (port 9090)\n\u2514\u2500 Grafana (port 3000)\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"2-sur-la-vm-ubuntu-app--mariadb",children:"2. Sur la VM Ubuntu (App + MariaDB)"}),"\n",(0,a.jsx)(n.h3,{id:"a-installer-node-exporter-monitoring-syst\xe8me",children:"a. Installer Node Exporter (monitoring syst\xe8me)"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"cd /opt\nsudo wget https://github.com/prometheus/node_exporter/releases/download/v1.8.1/node_exporter-1.8.1.linux-amd64.tar.gz\nsudo tar xvf node_exporter-1.8.1.linux-amd64.tar.gz\nsudo mv node_exporter-1.8.1.linux-amd64/node_exporter /usr/local/bin/\n"})}),"\n",(0,a.jsx)(n.p,{children:"Cr\xe9er un service systemd\u202f:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo nano /etc/systemd/system/node_exporter.service\n"})}),"\n",(0,a.jsx)(n.p,{children:"Contenu\u202f:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"[Unit]\nDescription=Node Exporter\nAfter=network.target\n\n[Service]\nUser=nobody\nExecStart=/usr/local/bin/node_exporter\n\n[Install]\nWantedBy=multi-user.target\n"})}),"\n",(0,a.jsx)(n.p,{children:"Activer et d\xe9marrer\u202f:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo systemctl daemon-reload\nsudo systemctl enable node_exporter\nsudo systemctl start node_exporter\n"})}),"\n",(0,a.jsxs)(n.p,{children:["V\xe9rifie sur\u202f: ",(0,a.jsx)(n.code,{children:"http://<IP_VM_UBUNTU>:9100/metrics"})]}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h3,{id:"b-installer-mysqld_exporter-monitoring-mariadb",children:"b. Installer mysqld_exporter (monitoring MariaDB)"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"1. Cr\xe9er un utilisateur MariaDB pour l\u2019exporter"}),"\nConnecte-toi \xe0 MariaDB\u202f:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo mariadb\n"})}),"\n",(0,a.jsx)(n.p,{children:"Dans le shell MariaDB\u202f:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"CREATE USER 'exporter'@'localhost' IDENTIFIED BY 'motdepasse_exporter';\nGRANT PROCESS, REPLICATION CLIENT, SELECT ON *.* TO 'exporter'@'localhost';\nFLUSH PRIVILEGES;\nEXIT;\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"2. Installer mysqld_exporter"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"cd /opt\nwget https://github.com/prometheus/mysqld_exporter/releases/download/v0.15.1/mysqld_exporter-0.15.1.linux-amd64.tar.gz\ntar xvf mysqld_exporter-0.15.1.linux-amd64.tar.gz\nsudo mv mysqld_exporter-0.15.1.linux-amd64/mysqld_exporter /usr/local/bin/\n"})}),"\n",(0,a.jsx)(n.p,{children:"Cr\xe9er le fichier de config\u202f:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo nano /etc/.mysqld_exporter.cnf\n"})}),"\n",(0,a.jsx)(n.p,{children:"Contenu\u202f:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"[client]\nuser=exporter\npassword=motdepasse_exporter\n"})}),"\n",(0,a.jsx)(n.p,{children:"Prot\xe9ger le fichier\u202f:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo chmod 600 /etc/.mysqld_exporter.cnf\n"})}),"\n",(0,a.jsx)(n.p,{children:"Cr\xe9er le service systemd\u202f:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo nano /etc/systemd/system/mysqld_exporter.service\n"})}),"\n",(0,a.jsx)(n.p,{children:"Contenu\u202f:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"[Unit]\nDescription=Prometheus MySQL Exporter\nAfter=network.target\n\n[Service]\nUser=nobody\nExecStart=/usr/local/bin/mysqld_exporter --config.my-cnf=/etc/.mysqld_exporter.cnf\n\n[Install]\nWantedBy=multi-user.target\n"})}),"\n",(0,a.jsx)(n.p,{children:"Activer et d\xe9marrer\u202f:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo systemctl daemon-reload\nsudo systemctl enable mysqld_exporter\nsudo systemctl start mysqld_exporter\n"})}),"\n",(0,a.jsxs)(n.p,{children:["V\xe9rifie sur\u202f: ",(0,a.jsx)(n.code,{children:"http://<IP_VM_UBUNTU>:9104/metrics"})]}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h3,{id:"c-exposer-les-m\xe9triques-de-lapplication-python",children:"c. Exposer les m\xe9triques de l\u2019application Python"}),"\n",(0,a.jsx)(n.p,{children:"Dans ton projet Flask, installe l\u2019exporter Prometheus\u202f:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"pip install prometheus_flask_exporter\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Dans ",(0,a.jsx)(n.code,{children:"app.py"}),"\u202f:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"from flask import Flask\nfrom prometheus_flask_exporter import PrometheusMetrics\n\napp = Flask(__name__)\nmetrics = PrometheusMetrics(app)\n\n@app.route('/')\ndef index():\n    return \"Hello, world!\"\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0')\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Les m\xe9triques seront disponibles sur\u202f:\n",(0,a.jsx)(n.code,{children:"http://<IP_VM_UBUNTU>:5000/metrics"})]}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"3-sur-la-vm-debian-monitoring",children:"3. Sur la VM Debian (Monitoring)"}),"\n",(0,a.jsx)(n.h3,{id:"a-installer-prometheus",children:"a. Installer Prometheus"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo apt update\nsudo apt install prometheus -y\n"})}),"\n",(0,a.jsx)(n.p,{children:"Prometheus \xe9coute sur le port 9090."}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h3,{id:"b-configurer-prometheus-pour-scraper-la-vm-ubuntu",children:"b. Configurer Prometheus pour scraper la VM Ubuntu"}),"\n",(0,a.jsxs)(n.p,{children:["\xc9dite ",(0,a.jsx)(n.code,{children:"/etc/prometheus/prometheus.yml"})," et ajoute dans ",(0,a.jsx)(n.code,{children:"scrape_configs"}),"\u202f:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"scrape_configs:\n  - job_name: 'node_exporter'\n    static_configs:\n      - targets: ['<IP_VM_UBUNTU>:9100']\n  - job_name: 'mysqld_exporter'\n    static_configs:\n      - targets: ['<IP_VM_UBUNTU>:9104']\n  - job_name: 'python_app'\n    metrics_path: /metrics\n    static_configs:\n      - targets: ['<IP_VM_UBUNTU>:5000']\n"})}),"\n",(0,a.jsx)(n.p,{children:"Red\xe9marre Prometheus\u202f:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo systemctl restart prometheus\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h3,{id:"c-installer-grafana",children:"c. Installer Grafana"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'sudo apt-get install -y apt-transport-https software-properties-common wget\nwget -q -O - https://packages.grafana.com/gpg.key | sudo apt-key add -\necho "deb https://packages.grafana.com/oss/deb stable main" | sudo tee /etc/apt/sources.list.d/grafana.list\nsudo apt update\nsudo apt install grafana -y\nsudo systemctl enable grafana-server\nsudo systemctl start grafana-server\n'})}),"\n",(0,a.jsxs)(n.p,{children:["Grafana est accessible sur\u202f:\n",(0,a.jsx)(n.code,{children:"http://<IP_VM_DEBIAN>:3000"}),"\nIdentifiants par d\xe9faut\u202f: ",(0,a.jsx)(n.code,{children:"admin"})," / ",(0,a.jsx)(n.code,{children:"admin"})]}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h3,{id:"d-connecter-grafana-\xe0-prometheus",children:"d. Connecter Grafana \xe0 Prometheus"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:"Connecte-toi \xe0 Grafana"}),"\n",(0,a.jsxs)(n.li,{children:["Va dans ",(0,a.jsx)(n.strong,{children:"Configuration > Data Sources > Add data source"})]}),"\n",(0,a.jsxs)(n.li,{children:["Choisis ",(0,a.jsx)(n.strong,{children:"Prometheus"})]}),"\n",(0,a.jsxs)(n.li,{children:["Renseigne l\u2019URL\u202f: ",(0,a.jsx)(n.code,{children:"http://localhost:9090"})," (si Grafana et Prometheus sont sur la m\xeame VM Debian)"]}),"\n",(0,a.jsxs)(n.li,{children:["Clique sur ",(0,a.jsx)(n.strong,{children:"Save & Test"})]}),"\n"]}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"4-cr\xe9er-et-importer-des-dashboards-grafana",children:"4. Cr\xe9er et importer des dashboards Grafana"}),"\n",(0,a.jsx)(n.h3,{id:"a-dashboard-syst\xe8me-node-exporter",children:"a. Dashboard syst\xe8me (Node Exporter)"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Dashboard ID\u202f: ",(0,a.jsx)(n.strong,{children:"1860"})," (",(0,a.jsx)(n.a,{href:"https://grafana.com/grafana/dashboards/1860-node-exporter-full/",children:"Node Exporter Full"}),")"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"b-dashboard-mariadbmysql",children:"b. Dashboard MariaDB/MySQL"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Dashboard ID\u202f: ",(0,a.jsx)(n.strong,{children:"7362"})," (",(0,a.jsx)(n.a,{href:"https://grafana.com/grafana/dashboards/7362-mysql-overview/",children:"MySQL Overview"}),")"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"c-dashboard-pour-lapplication-python-exemple-d\xe9taill\xe9",children:"c. Dashboard pour l\u2019application Python (exemple d\xe9taill\xe9)"}),"\n",(0,a.jsx)(n.h4,{id:"exemple-de-panels-pour-ton-dashboard-python",children:"Exemple de panels pour ton dashboard Python"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Nombre total de requ\xeates HTTP"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Titre"}),"\u202f: Total HTTP Requests"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Query"}),"\u202f:"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"sum(flask_http_request_total)\n"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Type"}),"\u202f: Stat"]}),"\n"]}),"\n",(0,a.jsxs)(n.ol,{start:"2",children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Nombre de requ\xeates par endpoint"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Titre"}),"\u202f: Requests per Endpoint"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Query"}),"\u202f:"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"sum by (endpoint) (flask_http_request_total)\n"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Type"}),"\u202f: Table ou Bar Chart"]}),"\n"]}),"\n",(0,a.jsxs)(n.ol,{start:"3",children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Temps moyen de r\xe9ponse"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Titre"}),"\u202f: Average Response Time (s)"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Query"}),"\u202f:"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"sum(rate(flask_http_request_duration_seconds_sum[1m])) / sum(rate(flask_http_request_duration_seconds_count[1m]))\n"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Type"}),"\u202f: Stat"]}),"\n"]}),"\n",(0,a.jsxs)(n.ol,{start:"4",children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Uptime de l\u2019application"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Titre"}),"\u202f: Application Uptime (heures)"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Query"}),"\u202f:"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'(time() - process_start_time_seconds{job="python_app"}) / 3600\n'})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Type"}),"\u202f: Stat"]}),"\n"]}),"\n",(0,a.jsxs)(n.ol,{start:"5",children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Utilisation m\xe9moire"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Titre"}),"\u202f: RAM utilis\xe9e (MB)"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Query"}),"\u202f:"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'process_resident_memory_bytes{job="python_app"} / 1024 / 1024\n'})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Type"}),"\u202f: Stat"]}),"\n"]}),"\n",(0,a.jsxs)(n.ol,{start:"6",children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Utilisation CPU"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Titre"}),"\u202f: CPU Time (s)"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Query"}),"\u202f:"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'process_cpu_seconds_total{job="python_app"}\n'})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Type"}),"\u202f: Stat"]}),"\n"]}),"\n",(0,a.jsx)(n.h4,{id:"comment-cr\xe9er-ce-dashboard-dans-grafana",children:"Comment cr\xe9er ce dashboard dans Grafana"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["Va dans ",(0,a.jsx)(n.strong,{children:"+ > Dashboard > Add new panel"})]}),"\n",(0,a.jsxs)(n.li,{children:["Pour chaque panel\u202f:","\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Colle la requ\xeate (query) Prometheus correspondante"}),"\n",(0,a.jsx)(n.li,{children:"Choisis le type de visualisation (Stat, Table, Bar Chart\u2026)"}),"\n",(0,a.jsx)(n.li,{children:"Donne un titre explicite"}),"\n",(0,a.jsxs)(n.li,{children:["Clique sur ",(0,a.jsx)(n.strong,{children:"Apply"})]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.li,{children:"Organise tes panels comme tu le souhaites"}),"\n",(0,a.jsxs)(n.li,{children:["Clique sur ",(0,a.jsx)(n.strong,{children:"Save dashboard"})," pour enregistrer"]}),"\n"]}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"5-ressources",children:"5. Ressources"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://prometheus.io/docs/",children:"Documentation officielle Prometheus"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://grafana.com/docs/",children:"Documentation officielle Grafana"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://github.com/rycus86/prometheus_flask_exporter",children:"Exporter Flask pour Prometheus"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://grafana.com/grafana/dashboards/1860-node-exporter-full/",children:"Node Exporter Dashboard (ID 1860)"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://grafana.com/grafana/dashboards/7362-mysql-overview/",children:"MariaDB/MySQL Dashboard (ID 7362)"})}),"\n"]}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"R\xe9sum\xe9"}),"\u202f:\nAvec ce setup, tu surveilles l\u2019\xe9tat de ta VM Ubuntu (app + MariaDB) et de ton application Python depuis une VM Debian d\xe9di\xe9e au monitoring, avec une interface web moderne, centralis\xe9e et accessible depuis n\u2019importe quel navigateur.\nTu as maintenant un exemple pr\xe9cis pour cr\xe9er un dashboard Grafana d\xe9di\xe9 \xe0 ton application Python, incluant uptime, requ\xeates, temps de r\xe9ponse, RAM, CPU, etc."]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>t});var s=r(6540);const a={},l=s.createContext(a);function i(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);