"use strict";(self.webpackChunkmy_tutorial_wiki=self.webpackChunkmy_tutorial_wiki||[]).push([[1475],{4418:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>u,frontMatter:()=>o,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"Mariadb perplexity","title":"Connecter une BD \xe0 une application Python","description":"Sommaire","source":"@site/docs/Mariadb perplexity.md","sourceDirName":".","slug":"/Mariadb perplexity","permalink":"/Nyxosaurus/docs/Mariadb perplexity","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Mariadb perplexity.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Cr\xe9er une app python","permalink":"/Nyxosaurus/docs/Cr\xe9er une app python"}}');var s=i(4848),t=i(8453);const o={},d="Connecter une BD \xe0 une application Python",l={},c=[{value:"Sommaire",id:"sommaire",level:2},{value:"1. Installation de MariaDB sur Ubuntu Server",id:"1-installation-de-mariadb-sur-ubuntu-server",level:2},{value:"Sur la VM Ubuntu Server, ex\xe9cute les commandes suivantes\u202f:",id:"sur-la-vm-ubuntu-server-ex\xe9cute-les-commandes-suivantes",level:3},{value:"S\xe9curisation de l\u2019installation",id:"s\xe9curisation-de-linstallation",level:3},{value:"Cr\xe9ation d\u2019une base de donn\xe9es et d\u2019un utilisateur",id:"cr\xe9ation-dune-base-de-donn\xe9es-et-dun-utilisateur",level:3},{value:"2. Gestion s\xe9curis\xe9e des identifiants avec un fichier <code>.env</code>",id:"2-gestion-s\xe9curis\xe9e-des-identifiants-avec-un-fichier-env",level:2},{value:"a. Cr\xe9er un fichier <code>.env</code>",id:"a-cr\xe9er-un-fichier-env",level:3},{value:"b. Ignorer le fichier <code>.env</code> dans Git",id:"b-ignorer-le-fichier-env-dans-git",level:3},{value:"c. Pousser le code (hors <code>.env</code>)",id:"c-pousser-le-code-hors-env",level:3},{value:"3. Bonnes pratiques suppl\xe9mentaires",id:"3-bonnes-pratiques-suppl\xe9mentaires",level:2},{value:"4. Exemple d\u2019arborescence de projet",id:"4-exemple-darborescence-de-projet",level:2},{value:"5. Connexion \xe0 MariaDB en Python",id:"5-connexion-\xe0-mariadb-en-python",level:2}];function a(e){const n={a:"a",admonition:"admonition",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"connecter-une-bd-\xe0-une-application-python",children:"Connecter une BD \xe0 une application Python"})}),"\n",(0,s.jsx)(n.h2,{id:"sommaire",children:"Sommaire"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#1-installation-de-mariadb-sur-ubuntu-server",children:"Installation de MariaDB sur Ubuntu Server"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsxs)(n.a,{href:"#2-gestion-s%C3%A9curis%C3%A9e-des-identifiants-avec-un-fichier-env",children:["Gestion s\xe9curis\xe9e des identifiants avec un fichier ",(0,s.jsx)(n.code,{children:".env"})]})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#3-bonnes-pratiques-suppl%C3%A9mentaires",children:"Bonnes pratiques suppl\xe9mentaires"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#4-exemple-darborescence-de-projet",children:"Exemple d\u2019arborescence de projet"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#5-Connexion-%C3%A0-mariadb-en-python",children:"Connexion \xe0 MariaDB en Python"})}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"1-installation-de-mariadb-sur-ubuntu-server",children:"1. Installation de MariaDB sur Ubuntu Server"}),"\n",(0,s.jsx)(n.h3,{id:"sur-la-vm-ubuntu-server-ex\xe9cute-les-commandes-suivantes",children:"Sur la VM Ubuntu Server, ex\xe9cute les commandes suivantes\u202f:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"sudo apt update\nsudo apt install mariadb-server mariadb-client -y\n"})}),"\n",(0,s.jsx)(n.p,{children:"V\xe9rifie que le service fonctionne\u202f:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo systemctl status mariadb\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"s\xe9curisation-de-linstallation",children:"S\xe9curisation de l\u2019installation"}),"\n",(0,s.jsx)(n.p,{children:"Lance le script de s\xe9curisation fourni par MariaDB :"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo mysql_secure_installation\n"})}),"\n",(0,s.jsx)(n.p,{children:"R\xe9ponds aux questions pour\u202f:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"D\xe9finir un mot de passe root"}),"\n",(0,s.jsx)(n.li,{children:"Supprimer les utilisateurs anonymes"}),"\n",(0,s.jsx)(n.li,{children:"D\xe9sactiver la connexion root \xe0 distance"}),"\n",(0,s.jsx)(n.li,{children:"Supprimer la base de test"}),"\n",(0,s.jsx)(n.li,{children:"Recharger les tables de privil\xe8ges"}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"danger",children:(0,s.jsxs)(n.mdxAdmonitionTitle,{children:['Il est recommand\xe9 de r\xe9pondre "',(0,s.jsx)(n.strong,{children:"Y"}),'" \xe0 toutes les questions pour une configuration s\xe9curis\xe9e.']})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"cr\xe9ation-dune-base-de-donn\xe9es-et-dun-utilisateur",children:"Cr\xe9ation d\u2019une base de donn\xe9es et d\u2019un utilisateur"}),"\n",(0,s.jsx)(n.p,{children:"Connecte-toi au shell MariaDB :"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo mariadb\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Cr\xe9e une base de donn\xe9es (remplace ",(0,s.jsx)(n.code,{children:"nom_de_la_base"})," par le nom souhait\xe9) :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"CREATE DATABASE nom_de_la_base;\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Cr\xe9e un utilisateur (remplace ",(0,s.jsx)(n.code,{children:"utilisateur"}),", ",(0,s.jsx)(n.code,{children:"mot_de_passe"})," et ",(0,s.jsx)(n.code,{children:"nom_de_la_base"})," par tes valeurs) :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"GRANT ALL ON nom_de_la_base.* TO 'utilisateur'@'localhost' IDENTIFIED BY 'mot_de_passe' WITH GRANT OPTION; \n#WITH GRANT OPTION permet de donner le droit \xe0 l'utilisateur de donner les m\xeames droits que celui dont il dispose \xe0 d'autres utilisateurs\n"})}),"\n",(0,s.jsx)(n.p,{children:"Recharge les privil\xe8ges pour appliquer les changements\u202f:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"FLUSH PRIVILEGES;\n"})}),"\n",(0,s.jsx)(n.p,{children:"V\xe9rifie la cr\xe9ation de la base de donn\xe9es et de l\u2019utilisateur si besoin :"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"SHOW DATABASES;\nSELECT User, Host FROM mysql.user;\n"})}),"\n",(0,s.jsx)(n.p,{children:"Quitte le shell MariaDB\u202f:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"exit\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.h2,{id:"2-gestion-s\xe9curis\xe9e-des-identifiants-avec-un-fichier-env",children:["2. Gestion s\xe9curis\xe9e des identifiants avec un fichier ",(0,s.jsx)(n.code,{children:".env"})]}),"\n",(0,s.jsxs)(n.h3,{id:"a-cr\xe9er-un-fichier-env",children:["a. Cr\xe9er un fichier ",(0,s.jsx)(n.code,{children:".env"})]}),"\n",(0,s.jsxs)(n.p,{children:["\xc0 la racine de ton projet, cr\xe9e un fichier nomm\xe9 ",(0,s.jsx)(n.code,{children:".env"}),"\u202f:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"DB_HOST=localhost\nDB_USER=mon_utilisateur\nDB_PASSWORD=mon_mot_de_passe\nDB_NAME=ma_base\n"})}),"\n",(0,s.jsx)(n.p,{children:"Remplis avec les infos correspondantes \xe0 l'\xe9tape pr\xe9c\xe9dente"}),"\n",(0,s.jsxs)(n.h3,{id:"b-ignorer-le-fichier-env-dans-git",children:["b. Ignorer le fichier ",(0,s.jsx)(n.code,{children:".env"})," dans Git"]}),"\n",(0,s.jsxs)(n.p,{children:["Cr\xe9er un fichier ",(0,s.jsx)(n.code,{children:".gitignore"})," dans la racine de ton dossier",(0,s.jsx)(n.br,{}),"\n","Ajoute ",(0,s.jsx)(n.code,{children:".env"})," \xe0 ton fichier ",(0,s.jsx)(n.code,{children:".gitignore"}),"\u202f(il s'agit juste d'\xe9crire ",(0,s.jsx)(n.code,{children:".env"})," dans le fichier ",(0,s.jsx)(n.code,{children:".gitignore"}),"et de le sauvegarder. Github se chargera d'interpr\xe9ter le ",(0,s.jsx)(n.code,{children:".gitignore"})," tout seul)"]}),"\n",(0,s.jsxs)(n.h3,{id:"c-pousser-le-code-hors-env",children:["c. Pousser le code (hors ",(0,s.jsx)(n.code,{children:".env"}),")"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'git add .\ngit commit -m "nomducommit"\ngit push\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"3-bonnes-pratiques-suppl\xe9mentaires",children:"3. Bonnes pratiques suppl\xe9mentaires"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsxs)(n.strong,{children:["Fournir un fichier ",(0,s.jsx)(n.code,{children:".env.example"})]})," dans ton d\xe9p\xf4t (structure sans valeurs sensibles) :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"DB_HOST=\nDB_USER=\nDB_PASSWORD=\nDB_NAME=\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsxs)(n.strong,{children:["Ne jamais pousser ",(0,s.jsx)(n.code,{children:".env"})]})," ou toute information sensible sur GitHub."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"S\xe9parer tes environnements"})," (d\xe9veloppement, production) avec diff\xe9rents fichiers ",(0,s.jsx)(n.code,{children:".env"})," si besoin."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"4-exemple-darborescence-de-projet",children:"4. Exemple d\u2019arborescence de projet"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"mon_projet/\n\u251c\u2500\u2500 app.py\n\u251c\u2500\u2500 .env # Ignor\xe9 par git, contient les identifiants r\xe9els\n\u251c\u2500\u2500 .env.example # Version sans secrets \xe0 partager\n\u251c\u2500\u2500 .gitignore\n\u251c\u2500\u2500 requirements.txt\n\u2514\u2500\u2500 ...\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"5-connexion-\xe0-mariadb-en-python",children:"5. Connexion \xe0 MariaDB en Python"}),"\n",(0,s.jsx)(n.p,{children:"Installe le connecteur si besoin\u202f:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"pip install mysql-connector-python python-dotenv\n"})}),"\n",(0,s.jsx)(n.p,{children:"Int\xe9grer \xe0 l'app python :"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"import os\nfrom dotenv import load_dotenv\nimport mysql.connector\n\nload_dotenv()\n\ntry:\n    connection = mysql.connector.connect(\n        host=os.getenv('DB_HOST'),\n        user=os.getenv('DB_USER'),\n        password=os.getenv('DB_PASSWORD'),\n        database=os.getenv('DB_NAME')\n    )\n    if connection.is_connected():\n        print(\"\u2705 Connexion r\xe9ussie \xe0 MariaDB\")\nexcept mysql.connector.Error as e:\n    print(f\"\u274c Erreur de connexion : {e}\")\nfinally:\n    if 'connection' in locals() and connection.is_connected():\n        connection.close()\n\n"})}),"\n",(0,s.jsx)(n.admonition,{title:"Faire Attention",type:"danger",children:(0,s.jsxs)(n.p,{children:["En bonne pratique de scripting, faite attention \xe0 rajouter les imports en haut du script et le restant AVANT la ligne de fin de script python (qui doit ressembler \xe0 \xe7a ",(0,s.jsx)(n.code,{children:"if __name__ == '__main__':     app.run(host='0.0.0.0', port=5000, debug=True))"})]})}),"\n",(0,s.jsx)(n.admonition,{title:"Comprendre le script",type:"tip",children:(0,s.jsxs)(n.p,{children:["Ici le script extrait les donn\xe9es du fichier .env et s'en sert pour se connecter \xe0 la base mariadb.",(0,s.jsx)(n.br,{}),"\n","Ensuite selon la r\xe9ussite ou l'\xe9chec de la connection, le script print le message correspondant",(0,s.jsx)(n.br,{}),"\n","Finalement, le script ferme la connexion \xe0 la base de donn\xe9e."]})})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>d});var r=i(6540);const s={},t=r.createContext(s);function o(e){const n=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);